<?php 
	$this->headScript()	->setIndent("	")
						->appendFile($this->baseUrl('js/swfobject.js'));
?>

<div id="bcwEditor"></div>
<script type="text/javascript">
	var flashvars = {
		baseXmlUrl: "<?php echo $this->bcwBaseUrl . $this->bcwEditorVersion ?>/assets/base.xml"
	};
	var params = {};
	params.quality = "high";
	params.bgcolor = "#ffffff";
	params.allowscriptaccess = "sameDomain";
	params.allowfullscreen = "true";
	var attributes = {};
	attributes.id = "BCWEditor";
	attributes.name = "BCWEditor";
	attributes.align = "middle";

	swfobject.embedSWF("<?php echo $this->bcwBaseUrl . $this->bcwEditorVersion ?>/BCWEditor.swf", "bcwEditor", "100%", "100%", "9.0", false, flashvars, params, attributes);
	var confFile = "";
	var shouldSave = false;
	  	
	function BCWEditor_ReadyHandler() {
		var confFile = window.parent.jQuery('#conf_file').val();
		if (jQuery.trim(confFile).length > 0) {
			var f = document.getElementById("BCWEditor");
			f.setConfXML(confFile);
		}
	}
	
	function BCWEditor_publishXML(xml) {
		confFile = unescape(xml);
		shouldSave = true;
	}
	
	function BCWEditor_close() {
		if (shouldSave)
			window.parent.jQuery('#conf_file').val(confFile);
			
		window.parent.jQuery('#bcw-editor').dialog('close');
	}	
</script>